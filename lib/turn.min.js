!function(t,e,a,i){"use strict";function r(t,e,a){if(a[0]&&"object"!=typeof a[0]){if(e[a[0]]!==i)return e[a[0]].apply(t,Array.prototype.slice.call(a,1));throw v('"'+a[0]+'" is not a method or property.')}return e.init.apply(t,a)}function s(t,e,a,i){return{css:{position:"absolute",top:t,left:e,overflow:i||"hidden",zIndex:a||"auto"}}}function n(t,e,a,i,r){var s=1-r,n=s*s*s,o=r*r*r;return h(Math.round(n*t.x+3*r*s*s*e.x+3*r*r*s*a.x+o*i.x),Math.round(n*t.y+3*r*s*s*e.y+3*r*r*s*a.y+o*i.y))}function o(t){return t/M*180}function h(t,e){return{x:t,y:e}}function p(){var t=/AppleWebkit\/([0-9\.]+)/i.exec(navigator.userAgent);return!t||parseFloat(t[1])>534.3}function d(t,e,a){return w&&a?" translate3d("+t+"px,"+e+"px, 0px) ":" translate("+t+"px, "+e+"px) "}function l(t){return" rotate("+t+"deg) "}function g(t,e){return Object.prototype.hasOwnProperty.call(e,t)}function c(){for(var t=["Moz","Webkit","Khtml","O","ms"],e=t.length,i="";e--;)t[e]+"Transform"in a.body.style&&(i="-"+t[e].toLowerCase()+"-");return i}function f(t,e,a,i,r){var s,n=[];if("-webkit-"==x){for(s=0;s<r;s++)n.push("color-stop("+i[s][0]+", "+i[s][1]+")");t.css({"background-image":"-webkit-gradient(linear, "+e.x+"% "+e.y+"%,"+a.x+"% "+a.y+"%, "+n.join(",")+" )"})}else{e={x:e.x/100*t.width(),y:e.y/100*t.height()},a={x:a.x/100*t.width(),y:a.y/100*t.height()};var o=a.x-e.x,p=a.y-e.y,d=Math.atan2(p,o),l=d-Math.PI/2,g=Math.abs(t.width()*Math.sin(l))+Math.abs(t.height()*Math.cos(l)),c=Math.sqrt(p*p+o*o),f=h(a.x<e.x?t.width():0,a.y<e.y?t.height():0),u=Math.tan(d),v=-1/u,w=(v*f.x-f.y-u*e.x+e.y)/(v-u),m={x:w,y:v*w-v*f.x+f.y},b=Math.sqrt(Math.pow(m.x-e.x,2)+Math.pow(m.y-e.y,2));for(s=0;s<r;s++)n.push(" "+i[s][1]+" "+100*(b+c*i[s][0])/g+"%");t.css({"background-image":x+"linear-gradient("+-d+"rad,"+n.join(",")+")"})}}function u(t,e,a){var i=b.Event(t);return e.trigger(i,a),i.isDefaultPrevented()?"prevented":i.isPropagationStopped()?"stopped":""}function v(t){console.error(t)}var w,m,b=t,x="",y="4.1.2",M=Math.PI,P=M/2,_="ontouchstart"in e,z=_?{down:"touchstart",move:"touchmove",up:"touchend",over:"touchstart",out:"touchend"}:{down:"mousedown",move:"mousemove",up:"mouseup",over:"mouseover",out:"mouseout"},O={forward:["br","tr"],backward:["bl","tl"],all:["tl","bl","tr","br","l","r"]},j=["single","double"],k=["ltr","rtl"],W={resizeTimeout:80,acceleration:!0,display:"double",duration:600,page:1,gradients:!0,turnCorners:"bl,br",sourceFolder:"",when:null},A={cornerSize:200},F=6,C={init:function(t){w="WebKitCSSMatrix"in e||"MozPerspective"in a.body.style,m=p(),x=c();var i,r=this,s=this.wrap('<div class="turn-container">').parent(),n=0,o=this.data(),h=this.children();if(t=b.extend({width:this.width(),height:this.height(),direction:this.attr("dir")||this.css("direction")||"ltr"},W,t),o.opts=t,o.pageObjs={},o.pages={},o.pageWrap={},o.pageZoom={},o.pagePlace={},o.pageMv=[],o.zoom=1,o.totalPages=t.pages||0,o.eventHandlers={touchStart:b.proxy(C._touchStart,this),touchMove:b.proxy(C._touchMove,this),touchEnd:b.proxy(C._touchEnd,this),start:b.proxy(C._eventStart,this)},t.when)for(i in t.when)g(i,t.when)&&this.on(i,t.when[i]);for(this.css({width:t.width,height:t.height}),this.turn("display",t.display),""!==t.direction&&this.turn("direction",t.direction),w&&!_&&t.acceleration&&this.transform(d(0,0,!0)),i=0;i<h.length;i++)"1"!=b(h[i]).attr("ignore")&&this.turn("addPage",++n,h[i]);return this.on(z.down,o.eventHandlers.touchStart).on("end",C._eventEnd).on("pressed",C._eventPressed).on("released",C._eventReleased).on("flip",C._flip),s.on("start",o.eventHandlers.start),b(a).on(z.move,o.eventHandlers.touchMove).on(z.up,o.eventHandlers.touchEnd),b(e).on("resize",C.resizeViewport.bind(r)),C.resizeViewport.call(r),this.turn("page",t.page),o.done=!0,this},addPage:function(t,e){var a,i=!1,r=this.data(),s=r.totalPages+1;if(e=e||b("<div>"),r.destroying)return!1;if(t){if(t==s)i=!0;else if(t>s)throw new Error('TurnJS: page "'+t+'" could not be inserted.')}else t=s,i=!0;return t>=1&&t<=s&&(a="double"==r.display?t%2?" odd":" even":"",r.done&&this.turn("stop"),t in r.pageObjs&&C._movePages.call(this,t,1),i&&(r.totalPages=s),r.pageObjs[t]=b(e).addClass("page page-"+t+a).data("page",t).html('<div class="gradient"/><div class="loader"/>'),navigator.userAgent.indexOf("MSIE 9.0")!=-1&&r.pageObjs[t].hasClass("hard")&&r.pageObjs[t].removeClass("hard"),C._addPage.call(this,t),C._removeFromDOM.call(this),C.loadPage.call(this,t,r.pageObjs[t])),this},_addPage:function(t){var e=this.data(),a=e.pageObjs[t]||!1;if(a)if(C._necessPage.call(this,t)){if(!e.pageWrap[t]){if("double"==e.display)var i=t%2?" odd":" even";else var i="";e.pageWrap[t]=b("<div>").addClass("page-wrapper"+i).data("page",t),this.append(e.pageWrap[t]),e.pagePlace[t]||(e.pagePlace[t]=t,e.pageObjs[t].appendTo(e.pageWrap[t]))}e.pagePlace[t]==t&&C._makeFlip.call(this,t)}else e.pagePlace[t]=0,e.pageObjs[t]&&e.pageObjs[t].remove()},loadPage:function(t,e){b("<img>").on("mousedown",function(t){t.preventDefault()}).on("load",function(){b(e).append(this),e.find(".loader").remove()}).attr("src",this.data().opts.sourceFolder+(t+1e3)+".jpg")},hasPage:function(t){return g(t,this.data().pageObjs)},center:function(t){var e=this.data(),a=b(this).turn("size"),i=0;if(!e.noCenter){if("double"==e.display){var r=this.turn("view",t||e.tpage||e.page);"ltr"==e.direction?r[0]?r[1]||(i+=a.width/4):i-=a.width/4:r[0]?r[1]||(i-=a.width/4):i+=a.width/4}b(this).css({marginLeft:i})}return this},destroy:function(){var t=this,e=this.data(),i=["end","first","flip","last","pressed","released","start","turning","turned","zooming","missing"];if("prevented"!=u("destroying",this)){for(e.destroying=!0,b.each(i,function(e,a){t.off(a)}),wrapper.off("start",e.eventHandlers.start),b(a).off(z.move,e.eventHandlers.touchMove).off(z.up,e.eventHandlers.touchEnd);0!==e.totalPages;)this.turn("removePage",e.totalPages);return e.fparent&&e.fparent.remove(),e.shadow&&e.shadow.remove(),this.removeData(),e=null,this}},is:function(){return"object"==typeof this.data().pages},zoom:function(t){var e=this.data();if("number"==typeof t){if(t<.001||t>100)throw v(t+" is not a value for zoom");if("prevented"==u("zooming",this,[t,e.zoom]))return this;var a=this.turn("size"),i=this.turn("view"),r=1/e.zoom,s=Math.round(a.width*r*t),n=Math.round(a.height*r*t);e.zoom=t,this.turn("stop").turn("size",s,n),e.opts.autoCenter&&this.turn("center"),C._updateShadow.call(this);for(var o=0;o<i.length;o++)i[o]&&e.pageZoom[i[o]]!=e.zoom&&(this.trigger("zoomed",[i[o],i,e.pageZoom[i[o]],e.zoom]),e.pageZoom[i[o]]=e.zoom);return this}return e.zoom},_pageSize:function(t,e){var a=this.data(),i={};if("single"==a.display)i.width=this.width(),i.height=this.height(),e&&(i.top=0,i.left=0,i.right="auto");else{var r=this.width()/2,s=this.height();if(a.pageObjs[t].hasClass("own-size")?(i.width=a.pageObjs[t].width(),i.height=a.pageObjs[t].height()):(i.width=r,i.height=s),e){var n=t%2;i.top=(s-i.height)/2,"ltr"==a.direction?(i[n?"right":"left"]=r-i.width,i[n?"left":"right"]="auto"):(i[n?"left":"right"]=r-i.width,i[n?"right":"left"]="auto")}}return i},_makeFlip:function(t){var e=this.data();if(!e.pages[t]&&e.pagePlace[t]==t){var a="single"==e.display,i=t%2;e.pages[t]=e.pageObjs[t].css(C._pageSize.call(this,t)).flip({page:t,next:i||a?t+1:t-1,turn:this}).flip("disable",e.disabled),C._setPageLoc.call(this,t),e.pageZoom[t]=e.zoom}return e.pages[t]},_makeRange:function(){var t,e,a=this.data();if(!(a.totalPages<1))for(e=this.turn("range"),t=e[0];t<=e[1];t++)C._addPage.call(this,t)},range:function(t){var e,a,i,r,s=this.data();if(t=t||s.tpage||s.page||1,r=C._view.call(this,t),t<1||t>s.totalPages)throw v('"'+t+'" is not a valid page');return r[1]=r[1]||r[0],r[0]>=1&&r[1]<=s.totalPages?(e=Math.floor((F-2)/2),s.totalPages-r[1]>r[0]?(a=Math.min(r[0]-1,e),i=2*e-a):(i=Math.min(s.totalPages-r[1],e),a=2*e-i)):(a=F-1,i=F-1),[Math.max(1,r[0]-a),Math.min(s.totalPages,r[1]+i)]},_necessPage:function(t){if(0===t)return!0;var e=this.turn("range");return this.data().pageObjs[t].hasClass("fixed")||t>=e[0]&&t<=e[1]},_removeFromDOM:function(){var t,e=this.data();for(t in e.pageWrap)g(t,e.pageWrap)&&!C._necessPage.call(this,t)&&C._removePageFromDOM.call(this,t)},_removePageFromDOM:function(t){var e=this.data();if(e.pages[t]){var a=e.pages[t].data();T._moveFoldingPage.call(e.pages[t],!1),a.f&&a.f.fwrapper&&a.f.fwrapper.remove(),e.pages[t].removeData(),e.pages[t].remove(),delete e.pages[t]}e.pageObjs[t]&&e.pageObjs[t].remove(),e.pageWrap[t]&&(e.pageWrap[t].remove(),delete e.pageWrap[t]),C._removeMv.call(this,t),delete e.pagePlace[t],delete e.pageZoom[t]},removePage:function(t){var e=this.data();if("*"==t)for(;0!==e.totalPages;)this.turn("removePage",e.totalPages);else{if(t<1||t>e.totalPages)throw v("The page "+t+" doesn't exist");e.pageObjs[t]&&(this.turn("stop"),C._removePageFromDOM.call(this,t),delete e.pageObjs[t]),C._movePages.call(this,t,-1),e.totalPages=e.totalPages-1,e.page>e.totalPages?(e.page=null,C._fitPage.call(this,e.totalPages)):(C._makeRange.call(this),this.turn("update"))}return this},_movePages:function(t,e){var a,i=this,r=this.data(),s="single"==r.display,n=function(t){var a=t+e,n=a%2,o=n?" odd":" even";r.pageObjs[t]&&(r.pageObjs[a]=r.pageObjs[t].removeClass("page-"+t+" odd even").addClass("page-"+a+o)),r.pagePlace[t]&&r.pageWrap[t]&&(r.pagePlace[a]=a,r.pageObjs[a].hasClass("fixed")?r.pageWrap[a]=r.pageWrap[t].data("page",a):r.pageWrap[a]=r.pageWrap[t].css(C._pageSize.call(i,a,!0)).data("page",a),r.pages[t]&&(r.pages[a]=r.pages[t].flip("options",{page:a,next:s||n?a+1:a-1})),e&&(delete r.pages[t],delete r.pagePlace[t],delete r.pageZoom[t],delete r.pageObjs[t],delete r.pageWrap[t]))};if(e>0)for(a=r.totalPages;a>=t;a--)n(a);else for(a=t;a<=r.totalPages;a++)n(a)},display:function(t){var e=this.data(),a=e.display;if(t===i)return a;if(b.inArray(t,j)==-1)throw v('"'+t+'" is not a value for display');switch(t){case"single":e.pageObjs[0]||(this.turn("stop").css("overflow","hidden"),e.pageObjs[0]=b("<div>").addClass("page p-temporal").css({width:this.width(),height:this.height()}).appendTo(this)),this.addClass("shadow");break;case"double":e.pageObjs[0]&&(this.turn("stop").css("overflow",""),e.pageObjs[0].remove(),delete e.pageObjs[0]),this.removeClass("shadow")}if(e.display=t,a){var r=this.turn("size");C._movePages.call(this,1,0),this.turn("size",r.width,r.height).turn("update")}return this},direction:function(t){var e=this.data();if(t===i)return e.direction;if(t=t.toLowerCase(),b.inArray(t,k)==-1)throw v('"'+t+'" is not a value for direction');return"rtl"==t&&b(this).attr("dir","ltr").css("direction","ltr"),e.direction=t,e.done&&this.turn("size",b(this).width(),b(this).height()),this},animating:function(){return this.data().pageMv.length>0},corner:function(){var t,e,a=this.data();for(e in a.pages)if(g(e,a.pages)&&(t=a.pages[e].flip("corner")))return t;return!1},data:function(){return this.data()},disable:function(t){var e,a=this.data(),r=this.turn("view");a.disabled=t===i||t===!0;for(e in a.pages)g(e,a.pages)&&a.pages[e].flip("disable",!!a.disabled||b.inArray(parseInt(e,10),r)==-1);return this},disabled:function(t){return t===i?this.data().disabled===!0:this.turn("disable",t)},size:function(t,e){if(t===i||e===i)return{width:this.width(),height:this.height()};this.turn("stop");var a,r,s=this.data(),n="double"==s.display?t/2:t;this.css({width:t,height:e}),s.pageObjs[0]&&s.pageObjs[0].css({width:n,height:e});for(a in s.pageWrap)g(a,s.pageWrap)&&(r=C._pageSize.call(this,a,!0),s.pageObjs[a].css({width:r.width,height:r.height}),s.pageWrap[a].css(r),s.pages[a]&&s.pages[a].css({width:r.width,height:r.height}));return this.turn("resize"),this},resize:function(){var t,e=this.data();for(e.pages[0]&&(e.pageWrap[0].css("left",-this.width()),e.pages[0].flip("resize",!0)),t=1;t<=e.totalPages;t++)e.pages[t]&&e.pages[t].flip("resize",!0);C._updateShadow.call(this),e.opts.autoCenter&&this.turn("center")},_removeMv:function(t){var e,a=this.data();for(e=0;e<a.pageMv.length;e++)if(a.pageMv[e]==t)return a.pageMv.splice(e,1),!0;return!1},_addMv:function(t){var e=this.data();C._removeMv.call(this,t),e.pageMv.push(t)},_view:function(t){var e=this.data();return t=t||e.page,"double"==e.display?t%2?[t-1,t]:[t,t+1]:[t]},view:function(t){var e=this.data(),a=C._view.call(this,t);return"double"==e.display?[a[0]>0?a[0]:0,a[1]<=e.totalPages?a[1]:0]:[a[0]>0&&a[0]<=e.totalPages?a[0]:0]},stop:function(t,e){if(this.turn("animating")){var a,i,r,s=this.data();for(s.tpage&&(s.page=s.tpage,delete s.tpage),a=0;a<s.pageMv.length;a++)s.pageMv[a]&&s.pageMv[a]!==t&&(r=s.pages[s.pageMv[a]],i=r.data().f.opts,r.flip("hideFoldedPage",e),e||T._moveFoldingPage.call(r,!1),i.force&&(i.next=i.page%2===0?i.page-1:i.page+1,delete i.force))}return this.turn("update"),this},pages:function(t){var e=this.data();if(t){if(t<e.totalPages)for(var a=e.totalPages;a>t;a--)this.turn("removePage",a);return e.totalPages=t,C._fitPage.call(this,e.page),this}return e.totalPages},_missing:function(t){var e=this.data();if(!(e.totalPages<1)){var a,i=this.turn("range",t),r=[];for(a=i[0];a<=i[1];a++)e.pageObjs[a]||r.push(a);r.length>0&&this.trigger("missing",[r])}},_fitPage:function(t){var e=this.data(),a=this.turn("view",t);if(C._missing.call(this,t),e.pageObjs[t]){e.page=t,this.turn("stop");for(var i=0;i<a.length;i++)a[i]&&e.pageZoom[a[i]]!=e.zoom&&(this.trigger("zoomed",[a[i],a,e.pageZoom[a[i]],e.zoom]),e.pageZoom[a[i]]=e.zoom);C._removeFromDOM.call(this),C._makeRange.call(this),C._updateShadow.call(this),this.trigger("turned",[t,a]),this.turn("update"),e.opts.autoCenter&&this.turn("center")}},_turnPage:function(t){var e,a,i=this.data(),r=i.pagePlace[t],s=this.turn("view"),n=this.turn("view",t);if(i.page!=t){var o=i.page;if("prevented"==u("turning",this,[t,n]))return void(o==i.page&&b.inArray(r,i.pageMv)!=-1&&i.pages[r].flip("hideFoldedPage",!0));b.inArray(1,n)!=-1&&this.trigger("first"),b.inArray(i.totalPages,n)!=-1&&this.trigger("last")}"single"==i.display?(e=s[0],a=n[0]):s[1]&&t>s[1]?(e=s[1],a=n[0]):s[0]&&t<s[0]&&(e=s[0],a=n[1]);var h=i.opts.turnCorners.split(","),p=i.pages[e].data().f,d=p.opts,l=p.point;C._missing.call(this,t),i.pageObjs[t]&&(this.turn("stop"),i.page=t,C._makeRange.call(this),i.tpage=a,d.next!=a&&(d.next=a,d.force=!0),this.turn("update"),p.point=l,"hard"==p.effect?"ltr"==i.direction?i.pages[e].flip("turnPage",t>e?"r":"l"):i.pages[e].flip("turnPage",t>e?"l":"r"):"ltr"==i.direction?i.pages[e].flip("turnPage",h[t>e?1:0]):i.pages[e].flip("turnPage",h[t>e?0:1]))},page:function(t){var e=this.data();if(t===i)return e.page;if(!e.disabled&&!e.destroying){if(t=parseInt(t,10),t>0&&t<=e.totalPages)return t!=e.page&&(e.done&&b.inArray(t,this.turn("view"))==-1?C._turnPage.call(this,t):C._fitPage.call(this,t)),this;throw v("The page "+t+" does not exist")}},next:function(){return this.turn("page",Math.min(this.data().totalPages,C._view.call(this,this.data().page).pop()+1))},previous:function(){return this.turn("page",Math.max(1,C._view.call(this,this.data().page).shift()-1))},peel:function(t,e){var a=this.data(),r=this.turn("view");if(e=e===i||e===!0,t===!1)this.turn("stop",null,e);else if("single"==a.display)a.pages[a.page].flip("peel",t,e);else{var s;s="ltr"==a.direction?t.indexOf("l")!=-1?r[0]:r[1]:t.indexOf("l")!=-1?r[1]:r[0],a.pages[s]&&a.pages[s].flip("peel",t,e)}return this},_addMotionPage:function(){var t=b(this).data().f.opts,e=t.turn;e.data();C._addMv.call(e,t.page)},_eventStart:function(t,e,a){var i=e.turn.data(),r=i.pageZoom[e.page];return t.isDefaultPrevented()?void C._updateShadow.call(e.turn):(r&&r!=i.zoom&&(e.turn.trigger("zoomed",[e.page,e.turn.turn("view",e.page),r,i.zoom]),i.pageZoom[e.page]=i.zoom),"single"==i.display&&a&&("l"==a.charAt(1)&&"ltr"==i.direction||"r"==a.charAt(1)&&"rtl"==i.direction?(e.next=e.next<e.page?e.next:e.page-1,e.force=!0):e.next=e.next>e.page?e.next:e.page+1),C._addMotionPage.call(t.target),void C._updateShadow.call(e.turn))},_eventEnd:function(t,e,a){var i=b(t.target),r=(i.data().f,e.turn),s=r.data();if(a){var n=s.tpage||s.page;n!=e.next&&n!=e.page||(delete s.tpage,C._fitPage.call(r,n||e.next,!0))}else C._removeMv.call(r,e.page),C._updateShadow.call(r),r.turn("update")},_eventPressed:function(t){var e=b(t.target).data().f,a=e.opts.turn,i=a.data();i.pages;return i.mouseAction=!0,a.turn("update"),e.time=(new Date).getTime()},_eventReleased:function(t,e){var a,i=b(t.target),r=i.data().f,s=r.opts.turn,n=s.data();a="single"==n.display?"br"==e.corner||"tr"==e.corner?e.x<i.width()/2:e.x>i.width()/2:e.x<0||e.x>i.width(),((new Date).getTime()-r.time<200||a)&&(t.preventDefault(),C._turnPage.call(s,r.opts.next)),n.mouseAction=!1},_flip:function(t){t.stopPropagation();var e=b(t.target).data().f.opts;e.turn.trigger("turn",[e.next]),e.turn.data().opts.autoCenter&&e.turn.turn("center",e.next)},_touchStart:function(){var t=this.data();for(var e in t.pages)if(g(e,t.pages)&&T._eventStart.apply(t.pages[e],arguments)===!1)return!1},_touchMove:function(){var t=this.data();for(var e in t.pages)g(e,t.pages)&&T._eventMove.apply(t.pages[e],arguments)},_touchEnd:function(){var t=this.data();for(var e in t.pages)g(e,t.pages)&&T._eventEnd.apply(t.pages[e],arguments)},calculateZ:function(t){var e,a,i,r,s,n=this,o=this.data(),h=this.turn("view"),p=h[0]||h[1],d=t.length-1,l={pageZ:{},partZ:{},pageV:{}},g=function(t){var e=n.turn("view",t);e[0]&&(l.pageV[e[0]]=!0),e[1]&&(l.pageV[e[1]]=!0)};for(e=0;e<=d;e++)a=t[e],i=o.pages[a].data().f.opts.next,r=o.pagePlace[a],g(a),g(i),s=o.pagePlace[i]==i?i:a,l.pageZ[s]=o.totalPages-Math.abs(p-s),l.partZ[r]=2*o.totalPages-d+e;return l},update:function(){var t,e=this.data();if(this.turn("animating")&&0!==e.pageMv[0]){var a,i,r=this.turn("calculateZ",e.pageMv),s=this.turn("corner"),n=this.turn("view"),o=this.turn("view",e.tpage);for(t in e.pageWrap)g(t,e.pageWrap)&&(i=e.pageObjs[t].hasClass("fixed"),e.pageWrap[t].css({display:r.pageV[t]||i?"":"none",zIndex:(e.pageObjs[t].hasClass("hard")?r.partZ[t]:r.pageZ[t])||(i?-1:0)}),(a=e.pages[t])&&(a.flip("z",r.partZ[t]||null),r.pageV[t]&&a.flip("resize"),e.tpage?a.flip("hover",!1).flip("disable",b.inArray(parseInt(t,10),e.pageMv)==-1&&t!=o[0]&&t!=o[1]):a.flip("hover",s===!1).flip("disable",t!=n[0]&&t!=n[1])))}else for(t in e.pageWrap)if(g(t,e.pageWrap)){var h=C._setPageLoc.call(this,t);e.pages[t]&&e.pages[t].flip("disable",e.disabled||1!=h).flip("hover",!0).flip("z",null)}return this},_updateShadow:function(){var t,e,a,i=this.data(),r=this.width(),n=this.height(),o="single"==i.display?r:r/2;t=this.turn("view"),i.shadow||(i.shadow=b("<div>").css(s(0,0,0).css).addClass("shadow").appendTo(this));for(var h=0;h<i.pageMv.length&&(t[0]&&t[1]);h++)t=this.turn("view",i.pages[i.pageMv[h]].data().f.opts.next),e=this.turn("view",i.pageMv[h]),t[0]=t[0]&&e[0],t[1]=t[1]&&e[1];switch(a=t[0]?t[1]?3:"ltr"==i.direction?2:1:"ltr"==i.direction?1:2){case 1:i.shadow.css({width:o,height:n,top:0,left:o});break;case 2:i.shadow.css({width:o,height:n,top:0,left:0});break;case 3:i.shadow.css({width:r,height:n,top:0,left:0})}},_setPageLoc:function(t){var e=this.data(),a=this.turn("view"),i=0;if(t==a[0]||t==a[1]?i=1:("single"==e.display&&t==a[0]+1||"double"==e.display&&t==a[0]-2||t==a[1]+2)&&(i=2),!this.turn("animating"))switch(i){case 1:e.pageWrap[t].css({zIndex:e.totalPages,display:""});break;case 2:e.pageWrap[t].css({zIndex:e.totalPages-1,display:""});break;case 0:e.pageWrap[t].css({zIndex:0,display:e.pageObjs[t].hasClass("fixed")?"":"none"})}return i},options:function(t){if(t===i)return this.data().opts;var e=this.data();if(b.extend(e.opts,t),t.pages&&this.turn("pages",t.pages),t.page&&this.turn("page",t.page),t.display&&this.turn("display",t.display),t.direction&&this.turn("direction",t.direction),t.width&&t.height&&this.turn("size",t.width,t.height),t.when)for(var a in t.when)g(a,t.when)&&this.off(a).on(a,t.when[a]);return this},version:function(){return y},resizeViewport:function(){function t(t){var e={width:t.width,height:t.height};if(e.width>t.boundWidth||e.height>t.boundHeight){var a=e.width/e.height;t.boundWidth/a>t.boundHeight&&t.boundHeight*a<=t.boundWidth?(e.width=Math.round(t.boundHeight*a),e.height=t.boundHeight):(e.width=t.boundWidth,e.height=Math.round(t.boundWidth/a))}return e}var a=b(e).width(),i=b(e).height(),r=this.data().opts;if(this.css({width:.9*a,height:.9*i}),1==b(".magazine").turn("zoom")){var s=t({width:r.width,height:r.height,boundWidth:Math.min(r.width,a),boundHeight:Math.min(r.height,i)});b(".magazine").turn("size",Math.floor(.9*s.width),Math.floor(.9*s.height)),1==b(".magazine").turn("page")&&b(".magazine").turn("peel","br"),s.width==this.width()&&s.height==this.height()||this.turn("size",Math.floor(.9*s.width),Math.floor(.9*s.height))}}},T={init:function(t){return this.data({f:{disabled:!1,hover:!1,effect:this.hasClass("hard")?"hard":"sheet"}}),this.flip("options",t),T._addPageWrapper.call(this),this},setData:function(t){var e=this.data();return e.f=b.extend(e.f,t),this},options:function(t){var e=this.data().f;return t?(T.setData.call(this,{opts:b.extend({},e.opts||A,t)}),this):e.opts},z:function(t){var e=this.data().f;return e.opts["z-index"]=t,e.fwrapper&&e.fwrapper.css({zIndex:t||parseInt(e.parent.css("z-index"),10)||0}),this},_cAllowed:function(){var t=this.data().f,e=t.opts.page,a=t.opts.turn.data(),i=e%2;return"hard"==t.effect?"ltr"==a.direction?[i?"r":"l"]:[i?"l":"r"]:"single"==a.display?1==e?"ltr"==a.direction?O.forward:O.backward:e==a.totalPages?"ltr"==a.direction?O.backward:O.forward:O.all:"ltr"==a.direction?O[i?"forward":"backward"]:O[i?"backward":"forward"]},_cornerActivated:function(t){var e=this.data().f,a=this.width(),i=this.height(),r={x:t.x,y:t.y,corner:""},s=e.opts.cornerSize;if(r.x<=0||r.y<=0||r.x>=a||r.y>=i)return!1;var n=T._cAllowed.call(this);switch(e.effect){case"hard":if(r.x>a-s)r.corner="r";else{if(!(r.x<s))return!1;r.corner="l"}break;case"sheet":if(r.y<s)r.corner+="t";else{if(!(r.y>=i-s))return!1;r.corner+="b"}if(r.x<=s)r.corner+="l";else{if(!(r.x>=a-s))return!1;r.corner+="r"}}return!(!r.corner||b.inArray(r.corner,n)==-1)&&r},_isIArea:function(t){var e=this.data().f.parent.offset();return t=_&&t.originalEvent?t.originalEvent.touches[0]:t,T._cornerActivated.call(this,{x:t.pageX-e.left,y:t.pageY-e.top})},_c:function(t,e){switch(e=e||0,t){case"tl":return h(e,e);case"tr":return h(this.width()-e,e);case"bl":return h(e,this.height()-e);case"br":return h(this.width()-e,this.height()-e);case"l":return h(e,0);case"r":return h(this.width()-e,0)}},_c2:function(t){switch(t){case"tl":return h(2*this.width(),0);case"tr":return h(-this.width(),0);case"bl":return h(2*this.width(),this.height());case"br":return h(-this.width(),this.height());case"l":return h(2*this.width(),0);case"r":return h(-this.width(),0)}},_foldingPage:function(){var t=this.data().f;if(t){var e=t.opts;return e.turn?(t=e.turn.data(),"single"==t.display?e.next>1||e.page>1?t.pageObjs[0]:null:t.pageObjs[e.next]):void 0}},_backGradient:function(){var t=this.data().f,e=t.opts.turn.data(),a=e.opts.gradients&&("single"==e.display||2!=t.opts.page&&t.opts.page!=e.totalPages-1);return a&&!t.bshadow&&(t.bshadow=b("<div/>",s(0,0,1)).css({position:"",width:this.width(),height:this.height()}).appendTo(t.parent)),a},type:function(){return this.data().f.effect},resize:function(t){var e=this.data().f,a=e.opts.turn.data(),i=this.width(),r=this.height();switch(e.effect){case"hard":t&&(e.wrapper.css({width:i,height:r}),e.fpage.css({width:i,height:r}),a.opts.gradients&&(e.ashadow.css({width:i,height:r}),e.bshadow.css({width:i,height:r})));break;case"sheet":if(t){var s=Math.round(Math.sqrt(Math.pow(i,2)+Math.pow(r,2)));e.wrapper.css({width:s,height:s}),e.fwrapper.css({width:s,height:s}).children(":first-child").css({width:i,height:r}),e.fpage.css({width:i,height:r}),a.opts.gradients&&e.ashadow.css({width:i,height:r}),T._backGradient.call(this)&&e.bshadow.css({width:i,height:r})}if(e.parent.is(":visible")){var n=e.parent.offset();console.log(e.fwrapper),e.fwrapper.css({top:n.top,left:n.left}),n=e.opts.turn.offset(),e.fparent.css({top:-n.top,left:-n.left})}this.flip("z",e.opts["z-index"])}},_addPageWrapper:function(){var t=this.data().f,e=t.opts.turn.data(),a=this.parent();if(t.parent=a,!t.wrapper)switch(t.effect){case"hard":var i={};i[x+"transform-style"]="preserve-3d",i[x+"backface-visibility"]="hidden",t.wrapper=b("<div/>",s(0,0,2)).css(i).appendTo(a).prepend(this),t.fpage=b("<div/>",s(0,0,1)).css(i).appendTo(a),e.opts.gradients&&(t.ashadow=b("<div/>",s(0,0,0)).hide().appendTo(a),t.bshadow=b("<div/>",s(0,0,0)));break;case"sheet":var r=this.width(),n=this.height();Math.round(Math.sqrt(Math.pow(r,2)+Math.pow(n,2)));if(t.fparent=t.opts.turn.data().fparent,!t.fparent){var o=b("<div/>",{css:{"pointer-events":"none"}}).hide();o.data().flips=0,o.css(s(0,0,"auto","visible").css).appendTo(t.opts.turn),t.opts.turn.data().fparent=o,t.fparent=o}this.css({position:"absolute",top:0,left:0,bottom:"auto",right:"auto"}),t.wrapper=b("<div/>",s(0,0,this.css("z-index"))).appendTo(a).prepend(this),t.fwrapper=b("<div/>",s(a.offset().top,a.offset().left)).hide().appendTo(t.fparent),t.fpage=b("<div/>",s(0,0,0,"visible")).css({cursor:"default"}).appendTo(t.fwrapper),e.opts.gradients&&(t.ashadow=b("<div/>",s(0,0,1)).appendTo(t.fpage)),T.setData.call(this,t)}T.resize.call(this,!0)},_fold:function(t){var e=this.data().f,a=e.opts.turn.data(),i=T._c.call(this,t.corner),r=this.width(),s=this.height();switch(e.effect){case"hard":"l"==t.corner?t.x=Math.min(Math.max(t.x,0),2*r):t.x=Math.max(Math.min(t.x,r),-r);var n,p,g,c,u,v=a.totalPages,w=e.opts["z-index"]||v,b={overflow:"visible"},y=i.x?(i.x-t.x)/r:t.x/r,_=90*y,z=_<90;switch(t.corner){case"l":c="0% 50%",u="100% 50%",z?(n=0,p=e.opts.next-1>0,g=1):(n="100%",p=e.opts.page+1<v,g=0);break;case"r":c="100% 50%",u="0% 50%",_=-_,r=-r,z?(n=0,p=e.opts.next+1<v,g=0):(n="-100%",p=1!=e.opts.page,g=1)}b[x+"perspective-origin"]=u,e.wrapper.transform("rotateY("+_+"deg) translate3d(0px, 0px, "+this.attr("depth")||"0px)",u),e.fpage.transform("translateX("+r+"px) rotateY("+(180+_)+"deg)",c),e.parent.css(b),z?(y=-y+1,e.wrapper.css({zIndex:w+1}),e.fpage.css({zIndex:w})):(y-=1,e.wrapper.css({zIndex:w}),e.fpage.css({zIndex:w+1})),a.opts.gradients&&(p?e.ashadow.css({display:"",left:n,backgroundColor:"rgba(0,0,0,"+.5*y+")"}).transform("rotateY(0deg)"):e.ashadow.hide(),e.bshadow.css({opacity:-y+1}),z?e.bshadow.parent()[0]!=e.wrapper[0]&&e.bshadow.appendTo(e.wrapper):e.bshadow.parent()[0]!=e.fpage[0]&&e.bshadow.appendTo(e.fpage),f(e.bshadow,h(100*g,0),h(100*(-g+1),0),[[0,"rgba(0,0,0,0.3)"],[1,"rgba(0,0,0,0)"]],2));break;case"sheet":var O,j,k,W,A,F,C,S=this,D=0,Z=0,I=h(0,0),q=h(0,0),E=h(0,0),H=T._foldingPage.call(this),R=(Math.tan(Z),a.opts.acceleration),V=e.wrapper.height(),L="t"==t.corner.substr(0,1),Y="l"==t.corner.substr(1,1),G=function(){var e=h(0,0),n=h(0,0);e.x=i.x?i.x-t.x:t.x,m?e.y=i.y?i.y-t.y:t.y:e.y=0,n.x=Y?r-e.x/2:t.x+e.x/2,n.y=e.y/2;var p=P-Math.atan2(e.y,e.x),d=p-Math.atan2(n.y,n.x),l=Math.max(0,Math.sin(d)*Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2)));if(D=o(p),E=h(l*Math.sin(p),l*Math.cos(p)),p>P&&(E.x=E.x+Math.abs(E.y*e.y/e.x),E.y=0,Math.round(E.x*Math.tan(M-p))<s))return t.y=Math.sqrt(Math.pow(s,2)+2*n.x*e.x),L&&(t.y=s-t.y),G();if(p>P){var g=M-p,c=V-s/Math.sin(g);I=h(Math.round(c*Math.cos(g)),Math.round(c*Math.sin(g))),Y&&(I.x=-I.x),L&&(I.y=-I.y)}O=Math.round(E.y/Math.tan(p)+E.x);var f=r-O,u=f*Math.cos(2*p),v=f*Math.sin(2*p);if(q=h(Math.round(Y?f-u:O+u),Math.round(L?v:s-v)),a.opts.gradients){A=f*Math.sin(p);var w=T._c2.call(S,t.corner),b=Math.sqrt(Math.pow(w.x-t.x,2)+Math.pow(w.y-t.y,2))/r;C=Math.sin(P*(b>1?2-b:b)),F=Math.min(b,1),W=A>100?(A-100)/A:0,j=h(A*Math.sin(p)/r*100,A*Math.cos(p)/s*100),T._backGradient.call(S)&&(k=h(1.2*A*Math.sin(p)/r*100,1.2*A*Math.cos(p)/s*100),Y||(k.x=100-k.x),L||(k.y=100-k.y))}return E.x=Math.round(E.x),E.y=Math.round(E.y),!0},X=function(t,i,n,o){var p=["0","auto"],g=(r-V)*n[0]/100,c=(s-V)*n[1]/100,u={left:p[i[0]],top:p[i[1]],right:p[i[2]],bottom:p[i[3]]},v={},w=90!=o&&o!=-90?Y?-1:1:0,m=n[0]+"% "+n[1]+"%";S.css(u).transform(l(o)+d(t.x+w,t.y,R),m),e.fpage.css(u).transform(l(o)+d(t.x+q.x-I.x-r*n[0]/100,t.y+q.y-I.y-s*n[1]/100,R)+l((180/o-2)*o),m),e.wrapper.transform(d(-t.x+g-w,-t.y+c,R)+l(-o),m),e.fwrapper.transform(d(-t.x+I.x+g,-t.y+I.y+c,R)+l(-o),m),a.opts.gradients&&(n[0]&&(j.x=100-j.x),n[1]&&(j.y=100-j.y),v["box-shadow"]="0 0 20px rgba(0,0,0,"+.5*C+")",H.css(v),f(e.ashadow,h(Y?100:0,L?0:100),h(j.x,j.y),[[W,"rgba(0,0,0,0)"],[.8*(1-W)+W,"rgba(0,0,0,"+.2*F+")"],[1,"rgba(255,255,255,"+.2*F+")"]],3,Z),T._backGradient.call(S)&&f(e.bshadow,h(Y?0:100,L?0:100),h(k.x,k.y),[[.6,"rgba(0,0,0,0)"],[.8,"rgba(0,0,0,"+.3*F+")"],[1,"rgba(0,0,0,0)"]],3))};switch(t.corner){case"l":break;case"r":break;case"tl":t.x=Math.max(t.x,1),G(),X(E,[1,0,0,1],[100,0],D);break;case"tr":t.x=Math.min(t.x,r-1),G(),X(h(-E.x,E.y),[0,0,0,1],[0,0],-D);break;case"bl":t.x=Math.max(t.x,1),G(),X(h(E.x,-E.y),[1,1,0,0],[100,100],-D);break;case"br":t.x=Math.min(t.x,r-1),G(),X(h(-E.x,-E.y),[0,1,1,0],[0,100],D)}}e.point=t},_moveFoldingPage:function(t){var e=this.data().f;if(e){var a=e.opts.turn,i=a.data(),r=i.pagePlace;if(t){var s=e.opts.next;if(r[s]!=e.opts.page){e.folding&&T._moveFoldingPage.call(this,!1);var n=T._foldingPage.call(this);n.appendTo(e.fpage),r[s]=e.opts.page,e.folding=s}a.turn("update")}else if(e.folding){if(i.pages[e.folding]){var o=i.pages[e.folding].data().f;i.pageObjs[e.folding].appendTo(o.wrapper)}else i.pageWrap[e.folding]&&i.pageObjs[e.folding].appendTo(i.pageWrap[e.folding]);e.folding in r&&(r[e.folding]=e.folding),delete e.folding}}},_showFoldedPage:function(t,e){var a=T._foldingPage.call(this),i=this.data(),r=i.f,s=r.visible;if(a){if(!s||!r.point||r.point.corner!=t.corner){var n="hover"==r.status||"peel"==r.status||r.opts.turn.data().mouseAction?t.corner:null;if(s=!1,"prevented"==u("start",this,[r.opts,n]))return!1}if(e){var o=this,h=r.point&&r.point.corner==t.corner?r.point:T._c.call(this,t.corner,1);this.animatef({from:[h.x,h.y],to:[t.x,t.y],duration:500,frame:function(e){t.x=Math.round(e[0]),t.y=Math.round(e[1]),T._fold.call(o,t)}})}else T._fold.call(this,t),i.effect&&!i.effect.turning&&this.animatef(!1);if(!s)switch(r.effect){case"hard":r.visible=!0,T._moveFoldingPage.call(this,!0),r.fpage.show(),r.opts.shadows&&r.bshadow.show();break;case"sheet":r.visible=!0,r.fparent.show().data().flips++,T._moveFoldingPage.call(this,!0),r.fwrapper.show(),r.bshadow&&r.bshadow.show()}return!0}return!1},hide:function(){var t=this.data().f,e=t.opts.turn.data(),a=T._foldingPage.call(this);switch(t.effect){case"hard":e.opts.gradients&&(t.bshadowLoc=0,t.bshadow.remove(),t.ashadow.hide()),t.wrapper.transform(""),t.fpage.hide();break;case"sheet":0===--t.fparent.data().flips&&t.fparent.hide(),this.css({left:0,top:0,right:"auto",bottom:"auto"}).transform(""),t.wrapper.transform(""),t.fwrapper.hide(),t.bshadow&&t.bshadow.hide(),a.transform("")}return t.visible=!1,this},hideFoldedPage:function(t){var e=this.data().f;if(e.point){var a=this,i=e.point,r=function(){e.point=null,e.status="",a.flip("hide"),a.trigger("end",[e.opts,!1])};if(t){var s=T._c.call(this,i.corner),o="t"==i.corner.substr(0,1),p=o?Math.min(0,i.y-s.y)/2:Math.max(0,i.y-s.y)/2,d=h(i.x,i.y+p),l=h(s.x,s.y-p);this.animatef({from:0,to:1,frame:function(t){var e=n(i,d,l,s,t);i.x=e.x,i.y=e.y,T._fold.call(a,i)},complete:r,duration:800,hiding:!0})}else this.animatef(!1),r()}},turnPage:function(t){var e=this,a=this.data().f;console.log(a);var i=a.opts.turn.data();t={corner:a.corner?a.corner.corner:t||T._cAllowed.call(this)[0]};var r=a.point||T._c.call(this,t.corner,a.opts.turn?i.opts.elevation:0),s=T._c2.call(this,t.corner);this.trigger("flip").animatef({from:0,to:1,frame:function(a){var i=n(r,r,s,s,a);t.x=i.x,t.y=i.y,T._showFoldedPage.call(e,t)},complete:function(){e.trigger("end",[a.opts,!0])},duration:i.opts.duration,turning:!0}),a.corner=null},moving:function(){return"effect"in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},corner:function(){return this.data().f.corner},_eventStart:function(t){var e=this.data().f,a=e.opts.turn;if(!e.corner&&!e.disabled&&!this.flip("isTurning")&&e.opts.page==a.data().pagePlace[e.opts.page]){
if(e.corner=T._isIArea.call(this,t),e.corner&&T._foldingPage.call(this))return this.trigger("pressed",[e.point]),T._showFoldedPage.call(this,e.corner),!1;e.corner=null}},_eventMove:function(t){var e=this.data().f;if(!e.disabled)if(t=_?t.originalEvent.touches:[t],e.corner){var a=e.parent.offset();e.corner.x=t[0].pageX-a.left,e.corner.y=t[0].pageY-a.top,T._showFoldedPage.call(this,e.corner)}else if(e.hover&&!this.data().effect&&this.is(":visible")){var i=T._isIArea.call(this,t[0]);if(i){if("sheet"==e.effect&&2==i.corner.length||"hard"==e.effect){e.status="hover";var r=T._c.call(this,i.corner,e.opts.cornerSize/2);i.x=r.x,i.y=r.y,T._showFoldedPage.call(this,i,!0)}}else"hover"==e.status&&(e.status="",T.hideFoldedPage.call(this,!0))}},_eventEnd:function(){var t=this.data().f,e=t.corner;!t.disabled&&e&&"prevented"!=u("released",this,[t.point||e])&&T.hideFoldedPage.call(this,!0),t.corner=null},disable:function(t){return T.setData.call(this,{disabled:t}),this},hover:function(t){return T.setData.call(this,{hover:t}),this},peel:function(t,e){var a=this.data().f;if(t){if(b.inArray(t,O.all)==-1)throw v("Corner "+t+" is not permitted");if(b.inArray(t,T._cAllowed.call(this))!=-1){var i=T._c.call(this,t,a.opts.cornerSize/2);a.status="peel",T._showFoldedPage.call(this,{corner:t,x:i.x,y:i.y},e)}}else a.status="",T.hideFoldedPage.call(this,e);return this}};e.requestAnim=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)}}(),b.extend(b.fn,{flip:function(){return r(this,T,arguments)},turn:function(){return r(this,C,arguments)},transform:function(t,e){var a={};return e!==i&&(a[x+"transform-origin"]=e),a[x+"transform"]=t,this.css(a)},animatef:function(t){var a=this.data();if(a.effect&&a.effect.stop(),t){t.to.length||(t.to=[t.to]),t.from.length||(t.from=[t.from]);for(var i=[],r=t.to.length,s=!0,n=this,o=(new Date).getTime(),h=function(){if(a.effect&&s){for(var p=[],d=Math.min(t.duration,(new Date).getTime()-o),l=0;l<r;l++)p.push(a.effect.easing(1,d,t.from[l],i[l],t.duration));t.frame(1==r?p[0]:p),d==t.duration?(delete a.effect,n.data(a),t.complete&&t.complete()):e.requestAnim(h)}},p=0;p<r;p++)i.push(t.to[p]-t.from[p]);a.effect=b.extend({stop:function(){s=!1},easing:function(t,e,a,i,r){return i*Math.sqrt(1-(e=e/r-1)*e)+a}},t),this.data(a),h()}else delete a.effect}})}(window.jQuery||!1,window,document);